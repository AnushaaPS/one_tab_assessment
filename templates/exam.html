<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Secure Assessment - Exam</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <script>
    // Anti-cheat: block context menu & many hotkeys
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', function(e){
      const blocked = ['c','x','v','a','s','p','f','u','k','l','j'];
      if ((e.ctrlKey || e.metaKey) && blocked.includes(e.key.toLowerCase())) { e.preventDefault(); }
      if (e.key === 'PrintScreen') { e.preventDefault(); }
      if (e.key === 'F12') { e.preventDefault(); }
    });
    document.addEventListener('copy', e => e.preventDefault());
    document.addEventListener('cut', e => e.preventDefault());
    document.addEventListener('paste', e => e.preventDefault());
  </script>
</head>
<body class="bg-white">
  <div class="container py-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h5 class="mb-0">Aptitude + {{ department }} Assessment</h5>
        <small class="text-muted">{{ name }} | {{ rollno }}</small>
      </div>
      <div class="text-end">
        <div id="timer" class="badge bg-dark fs-6 p-2">--:--:--</div>
        <div id="viowarn" class="small text-danger"></div>
      </div>
    </div>

    <div class="alert alert-info rounded-4">
      <strong>Instructions:</strong> The test runs in full-screen. Do not switch apps or tabs. Exiting full-screen or leaving the page increases your violation count.
      <button id="goFS" class="btn btn-sm btn-primary ms-2 rounded-4">Enter Full Screen</button>
    </div>

    <form id="examForm" method="POST" action="{{ url_for('exam') }}">
      <input type="hidden" name="answers_json" id="answers_json" />
      {% if questions %}
<div class="list-group">
  {% for q in questions %}
    <div class="list-group-item mb-3 rounded-4 shadow-sm text-start">
      
      <!-- Question number + text in single line -->
      <div class="mb-2">
        <span class="fw-semibold">{{ loop.index }}. {{ q.text }}</span>
      </div>

      <!-- Options in one row -->
      <div class="d-flex flex-wrap gap-4 text-start">
        {% for opt in q.options %}
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio"
                   name="{{ q.id }}"
                   id="{{ q.id }}_{{ loop.index0 }}"
                   value="{{ opt }}">
            <label class="form-check-label" for="{{ q.id }}_{{ loop.index0 }}">
              {{ opt }}
            </label>
          </div>
        {% endfor %}
      </div>

    </div>
  {% endfor %}
</div>
{% else %}
  <div class="alert alert-warning mt-3">
    No questions are available for your department at the moment.
  </div>
{% endif %}
      <div class="d-grid my-4">
        <button type="submit" class="btn btn-success btn-lg rounded-4">Submit</button>
      </div>
    </form>
  </div>

  <script src="{{ url_for('static', filename='js/exam.js') }}"></script>
  <script> window.EXAM_DURATION_MIN = {{ duration_min|tojson }}; </script>
</body>
</html>
